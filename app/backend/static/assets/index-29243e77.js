import{bE as z,bF as e,bG as Ct,bH as Le,bI as St,bJ as yt,r as c,bK as Oe,bL as vt,bM as bt,bN as jt,bO as Tt,bP as wt,bQ as kt,bR as Nt,bS as Lt,bT as At,bU as It,bV as Pt,bW as Ae,bX as Et}from"./vendor-3b0eb66e.js";import{D as Be,S as y,I as Ie,P as Rt,T as pe,a as Mt,B as fe,b as Gt,c as ue,d as qe,C as Ot,e as Pe,L as Bt,f as qt,g as Ft,h as Ee,i as Ut,j as Vt,k as $t,l as M,m as Ht,n as Dt,o as Qt}from"./fluentui-react-cc049b91.js";import{e as zt,E as Kt,f as Wt,g as Jt,D as Xt,h as Yt}from"./fluentui-icons-cc979dd7.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const d of o)if(d.type==="childList")for(const r of d.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function n(o){const d={};return o.integrity&&(d.integrity=o.integrity),o.referrerPolicy&&(d.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?d.credentials="include":o.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function l(o){if(o.ep)return;o.ep=!0;const d=n(o);fetch(o.href,d)}})();const Zt=".auth/me",es=".auth/refresh",ts=".auth/logout?post_logout_redirect_uri=/";async function ss(){const t=await fetch("/auth_setup");if(!t.ok)throw new Error(`auth setup response was not ok: ${t.status}`);return await t.json()}const F=await ss(),P=F.useLogin,D=F.requireAccessControl,ns=F.msalConfig,os=F.loginRequest,as=F.tokenRequest,Fe=()=>window.location.origin+F.msalConfig.auth.redirectUri,rs=()=>fetch(es).then(t=>t.ok?fetch(Zt).then(s=>s.ok?s.json().then(n=>n.length>0?{id_token:n[0].id_token,access_token:n[0].access_token,user_claims:n[0].user_claims.reduce((l,o)=>(l[o.typ]=o.val,l),{})}:null):null):null),G=await rs(),is=()=>{window.location.href=ts},me=t=>t?.getActiveAccount()!=null||G!=null,ge=t=>G?Promise.resolve(G.access_token):t.acquireTokenSilent({...as,redirectUri:Fe()}).then(s=>s.accessToken).catch(s=>{console.log(s)});const cs="/assets/github-fab00c2d.svg",ls="_layout_1nrkm_1",us="_header_1nrkm_7",ds="_headerContainer_1nrkm_12",hs="_headerTitleContainer_1nrkm_20",ps="_headerLogo_1nrkm_28",ms="_headerTitle_1nrkm_20",gs="_headerNavList_1nrkm_37",xs="_headerNavPageLink_1nrkm_43",_s="_headerNavPageLinkActive_1nrkm_57",fs="_headerNavLeftMargin_1nrkm_62",Cs="_headerRightText_1nrkm_66",Ss="_microsoftLogo_1nrkm_71",ys="_githubLogo_1nrkm_76",v={layout:ls,header:us,headerContainer:ds,headerTitleContainer:hs,headerLogo:ps,headerTitle:ms,headerNavList:gs,headerNavPageLink:xs,headerNavPageLinkActive:_s,headerNavLeftMargin:fs,headerRightText:Cs,microsoftLogo:Ss,githubLogo:ys},vs="_loginButton_m8yze_1",bs={loginButton:vs},js=()=>{const{instance:t}=z(),s=t.getActiveAccount(),n=(s||G)!=null,l=()=>{t.loginPopup({...os,redirectUri:Fe()}).catch(r=>console.log(r))},o=()=>{s?t.logoutPopup({mainWindowRedirectUri:"/",account:t.getActiveAccount()}).catch(r=>console.log(r)):is()},d=`Logout
${s?.username??G?.user_claims?.preferred_username}`;return e.jsx(Be,{text:n?d:"Login",className:bs.loginButton,onClick:n?o:l})},Re=()=>e.jsxs("div",{className:v.layout,children:[e.jsx("header",{className:v.header,role:"banner",children:e.jsxs("div",{className:v.headerContainer,children:[e.jsx(Ct,{to:"/",className:v.headerTitleContainer,children:e.jsx("h3",{className:v.headerTitle,children:"CHEFBOT | beta"})}),e.jsx("nav",{children:e.jsxs("ul",{className:v.headerNavList,children:[e.jsx("li",{children:e.jsx(Le,{to:"/",className:({isActive:t})=>t?v.headerNavPageLinkActive:v.headerNavPageLink,children:"Converse"})}),e.jsx("li",{className:v.headerNavLeftMargin,children:e.jsx(Le,{to:"/qa",className:({isActive:t})=>t?v.headerNavPageLinkActive:v.headerNavPageLink,children:"FaÃ§a uma pergunta"})}),e.jsx("li",{className:v.headerNavLeftMargin,children:e.jsx("a",{href:"https://aka.ms/entgptsearch",target:"_blank",title:"Github repository link",children:e.jsx("img",{src:cs,alt:"Github logo","aria-label":"Link to github repository",width:"20px",height:"20px",className:v.githubLogo})})})]})}),e.jsx("h4",{className:v.headerRightText,children:"Creator: Matheus Vicente"}),P&&e.jsx(js,{})]})}),e.jsx(St,{})]}),Ts="_container_18ti9_1",ws="_chatRoot_18ti9_8",ks="_chatContainer_18ti9_13",Ns="_chatEmptyState_18ti9_21",Ls="_chatEmptyStateTitle_18ti9_31",As="_chatEmptyStateSubtitle_18ti9_38",Is="_chatMessageStream_18ti9_54",Ps="_chatMessageGpt_18ti9_66",Es="_chatMessageGptMinWidth_18ti9_73",Rs="_chatInput_18ti9_78",Ms="_chatAnalysisPanel_18ti9_91",Gs="_chatSettingsSeparator_18ti9_99",Os="_loadingLogo_18ti9_103",Bs="_commandsContainer_18ti9_107",qs="_commandButton_18ti9_112",p={container:Ts,chatRoot:ws,chatContainer:ks,chatEmptyState:Ns,chatEmptyStateTitle:Ls,chatEmptyStateSubtitle:As,chatMessageStream:Is,chatMessageGpt:Ps,chatMessageGptMinWidth:Es,chatInput:Rs,chatAnalysisPanel:Ms,chatSettingsSeparator:Gs,loadingLogo:Os,commandsContainer:Bs,commandButton:qs},se="";function ne(t){var s={"Content-Type":"application/json"};return P&&G==null&&t&&(s.Authorization=`Bearer ${t}`),s}async function to(t,s){const n=await fetch(`${se}/ask`,{method:"POST",headers:ne(s),body:JSON.stringify(t)}),l=await n.json();if(n.status>299||!n.ok)throw Error(l.error||"Unknown error");return l}async function Fs(t){return await(await fetch(`${se}/config`,{method:"GET",headers:ne(t)})).json()}async function Us(t,s){return await fetch(`${se}/chat`,{method:"POST",headers:ne(s),body:JSON.stringify(t)})}function Ue(t){return`${se}/content/${t}`}var b=(t=>(t.Hybrid="hybrid",t.Vectors="vectors",t.Text="text",t))(b||{}),I=(t=>(t.TextAndImages="textAndImages",t.Images="images",t.Texts="texts",t))(I||{}),k=(t=>(t.Embedding="embedding",t.ImageEmbedding="imageEmbedding",t.Both="both",t))(k||{});const Vs="_answerContainer_1sqax_1",$s="_answerLogo_1sqax_11",Hs="_answerText_1sqax_15",Ds="_selected_1sqax_34",Qs="_citationLearnMore_1sqax_38",zs="_citation_1sqax_38",Ks="_followupQuestionsList_1sqax_60",Ws="_followupQuestionLearnMore_1sqax_64",Js="_followupQuestion_1sqax_60",Xs="_supContainer_1sqax_83",Ys="_retryButton_1sqax_112",Zs="_loadingdots_1sqax_134",en="_loading_1sqax_134",j={answerContainer:Vs,answerLogo:$s,answerText:Hs,selected:Ds,citationLearnMore:Qs,citation:zs,followupQuestionsList:Ks,followupQuestionLearnMore:Ws,followupQuestion:Js,supContainer:Xs,retryButton:Ys,loadingdots:Zs,loading:en};function tn(t,s,n){const l=[];let o=t.trim();if(s){let u=o.length;for(let m=o.length-1;m>=0&&o[m]!=="]";m--)if(o[m]==="["){u=m;break}o=o.substring(0,u)}return{answerHtml:o.split(/\[([^\]]+)\]/g).map((u,x)=>{if(x%2===0)return u;{let m;l.indexOf(u)!==-1?m=l.indexOf(u)+1:(l.push(u),m=l.length);const h=Ue(u);return yt(e.jsx("a",{className:"supContainer",title:u,onClick:()=>n(h),children:e.jsx("sup",{children:m})}))}}).join(""),citations:l}}const Ve=()=>e.jsx(zt,{primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Answer logo"}),Me=({answer:t,isSelected:s,isStreaming:n,onCitationClicked:l,onThoughtProcessClicked:o,onSupportingContentClicked:d,onFollowupQuestionClicked:r,showFollowupQuestions:u})=>{const x=t.choices[0].context.followup_questions,m=t.choices[0].message.content,h=c.useMemo(()=>tn(m,n,l),[t]),g=Oe.sanitize(h.answerHtml);return e.jsxs(y,{className:`${j.answerContainer} ${s&&j.selected}`,verticalAlign:"space-between",children:[e.jsx(y.Item,{children:e.jsxs(y,{horizontal:!0,horizontalAlign:"space-between",children:[e.jsx(Ve,{}),e.jsxs("div",{children:[e.jsx(Ie,{style:{color:"black"},iconProps:{iconName:"Lightbulb"},title:"Show thought process",ariaLabel:"Show thought process",onClick:()=>o(),disabled:!t.choices[0].context.thoughts?.length}),e.jsx(Ie,{style:{color:"black"},iconProps:{iconName:"ClipboardList"},title:"Show supporting content",ariaLabel:"Show supporting content",onClick:()=>d(),disabled:!t.choices[0].context.data_points})]})]})}),e.jsx(y.Item,{grow:!0,children:e.jsx("div",{className:j.answerText,dangerouslySetInnerHTML:{__html:g}})}),!!h.citations.length&&e.jsx(y.Item,{children:e.jsxs(y,{horizontal:!0,wrap:!0,tokens:{childrenGap:5},children:[e.jsx("span",{className:j.citationLearnMore,children:"Citations:"}),h.citations.map((_,C)=>{const L=Ue(_);return e.jsx("a",{className:j.citation,title:_,onClick:()=>l(L),children:`${++C}. ${_}`},C)})]})}),!!x?.length&&u&&r&&e.jsx(y.Item,{children:e.jsxs(y,{horizontal:!0,wrap:!0,className:`${h.citations.length?j.followupQuestionsList:""}`,tokens:{childrenGap:6},children:[e.jsx("span",{className:j.followupQuestionLearnMore,children:"Follow-up questions:"}),x.map((_,C)=>e.jsx("a",{className:j.followupQuestion,title:_,onClick:()=>r(_),children:`${_}`},C))]})})]})},sn=()=>{const t=vt({from:{opacity:0},to:{opacity:1}});return e.jsx(bt.div,{style:{...t},children:e.jsxs(y,{className:j.answerContainer,verticalAlign:"space-between",children:[e.jsx(Ve,{}),e.jsx(y.Item,{grow:!0,children:e.jsxs("p",{className:j.answerText,children:["Generating answer",e.jsx("span",{className:j.loadingdots})]})})]})})},nn=({error:t,onRetry:s})=>e.jsxs(y,{className:j.answerContainer,verticalAlign:"space-between",children:[e.jsx(Kt,{"aria-hidden":"true","aria-label":"Error icon",primaryFill:"red"}),e.jsx(y.Item,{grow:!0,children:e.jsx("p",{className:j.answerText,children:t})}),e.jsx(Rt,{className:j.retryButton,onClick:s,text:"Retry"})]}),on="_questionInputContainer_hiipw_1",an="_questionInputTextArea_hiipw_12",rn="_questionInputButtonsContainer_hiipw_17",de={questionInputContainer:on,questionInputTextArea:an,questionInputButtonsContainer:rn},cn=({onSend:t,disabled:s,placeholder:n,clearOnSend:l,initQuestion:o})=>{const[d,r]=c.useState("");c.useEffect(()=>{o&&r(o)},[o]);const u=()=>{s||!d.trim()||(t(d),l&&r(""))},x=C=>{C.key==="Enter"&&!C.shiftKey&&(C.preventDefault(),u())},m=(C,L)=>{L?L.length<=1e3&&r(L):r("")},{instance:h}=z(),g=D&&!me(h),_=s||!d.trim()||g;return g&&(n="Please login to continue..."),e.jsxs(y,{horizontal:!0,className:de.questionInputContainer,children:[e.jsx(pe,{className:de.questionInputTextArea,disabled:g,placeholder:n,multiline:!0,resizable:!1,borderless:!0,value:d,onChange:m,onKeyDown:x}),e.jsx("div",{className:de.questionInputButtonsContainer,children:e.jsx(Mt,{content:"Ask question button",relationship:"label",children:e.jsx(fe,{size:"large",icon:e.jsx(Wt,{primaryFill:"rgba(115, 118, 225, 1)"}),disabled:_,onClick:u})})})]})},ln="_examplesNavList_o3hyg_1",un="_example_o3hyg_1",dn="_exampleText_o3hyg_29",xe={examplesNavList:ln,example:un,exampleText:dn},hn=({text:t,value:s,onClick:n})=>e.jsx("div",{className:xe.example,onClick:()=>n(s),children:e.jsx("p",{className:xe.exampleText,children:t})}),pn=["What is included in my Northwind Health Plus plan that is not in standard?","What happens in a performance review?","What does a Product Manager do?"],mn=["Compare the impact of interest rates and GDP in financial markets.","What is the expected trend for the S&P 500 index over the next five years? Compare it to the past S&P 500 performance","Can you identify any correlation between oil prices and stock market trends?"],gn=({onExampleClicked:t,useGPT4V:s})=>e.jsx("ul",{className:xe.examplesNavList,children:(s?mn:pn).map((n,l)=>e.jsx("li",{children:e.jsx(hn,{text:n,value:n,onClick:t})},l))}),xn="_container_1p3pb_1",_n="_message_1p3pb_9",Ge={container:xn,message:_n},te=({message:t})=>e.jsx("div",{className:Ge.container,children:e.jsx("div",{className:Ge.message,children:t})}),fn="_thoughtProcess_1nmyh_1",Cn="_tList_1nmyh_8",Sn="_tListItem_1nmyh_14",yn="_tStep_1nmyh_40",vn="_tCodeBlock_1nmyh_46",bn="_tProp_1nmyh_50",jn="_citationImg_1nmyh_58",q={thoughtProcess:fn,tList:Cn,tListItem:Sn,tStep:yn,tCodeBlock:vn,tProp:bn,citationImg:jn};function Tn(t){const s=t.split(": "),n=s[0],l=Oe.sanitize(s.slice(1).join(": "));return{title:n,content:l}}const wn="_supportingContentNavList_beb5d_1",kn="_supportingContentItem_beb5d_9",Nn="_supportingContentItemHeader_beb5d_23",Ln="_supportingContentItemText_beb5d_27",An="_supportingContentItemImage_beb5d_32",Q={supportingContentNavList:wn,supportingContentItem:kn,supportingContentItemHeader:Nn,supportingContentItemText:Ln,supportingContentItemImage:An},In=({supportingContent:t})=>{const s=Array.isArray(t)?t:t.text,n=Array.isArray(t)?[]:t?.images;return e.jsxs("ul",{className:Q.supportingContentNavList,children:[s.map(l=>{const o=Tn(l);return e.jsx(Pn,{...o})}),n?.map(l=>e.jsx("img",{className:Q.supportingContentItemImage,src:l.url}))]})},Pn=({title:t,content:s})=>e.jsxs("li",{className:Q.supportingContentItem,children:[e.jsx("h4",{className:Q.supportingContentItemHeader,children:t}),e.jsx("p",{className:Q.supportingContentItemText,dangerouslySetInnerHTML:{__html:s}})]});var N=(t=>(t.ThoughtProcessTab="thoughtProcess",t.SupportingContentTab="supportingContent",t.CitationTab="citation",t))(N||{});const En=({thoughts:t})=>e.jsx("ul",{className:q.tList,children:t.map(s=>e.jsxs("li",{className:q.tListItem,children:[e.jsx("div",{className:q.tStep,children:s.title}),Array.isArray(s.description)?e.jsx(jt,{language:"json",wrapLongLines:!0,className:q.tCodeBlock,children:JSON.stringify(s.description,null,2)}):e.jsxs(e.Fragment,{children:[e.jsx("div",{children:s.description}),e.jsx(y,{horizontal:!0,tokens:{childrenGap:5},children:s.props&&(Object.keys(s.props)||[]).map(n=>e.jsxs("span",{className:q.tProp,children:[n,": ",JSON.stringify(s.props?.[n])]}))})]})]}))}),he={disabled:!0,style:{color:"grey"}},Rn=({answer:t,activeTab:s,activeCitation:n,citationHeight:l,className:o,onActiveTabChanged:d})=>{const r=!t.choices[0].context.thoughts,u=!t.choices[0].context.data_points,x=!n,[m,h]=c.useState(""),g=P?z().instance:void 0,_=async()=>{const C=g?await ge(g):void 0;if(n){const oe=await(await fetch(n,{method:"GET",headers:ne(C)})).blob(),K=URL.createObjectURL(oe);h(K)}};return c.useEffect(()=>{_()},[]),e.jsxs(Gt,{className:o,selectedKey:s,onLinkClick:C=>C&&d(C.props.itemKey),children:[e.jsx(ue,{itemKey:N.ThoughtProcessTab,headerText:"Thought process",headerButtonProps:r?he:void 0,children:e.jsx(En,{thoughts:t.choices[0].context.thoughts||[]})}),e.jsx(ue,{itemKey:N.SupportingContentTab,headerText:"Supporting content",headerButtonProps:u?he:void 0,children:e.jsx(In,{supportingContent:t.choices[0].context.data_points})}),e.jsx(ue,{itemKey:N.CitationTab,headerText:"Citation",headerButtonProps:x?he:void 0,children:n?.endsWith(".png")?e.jsx("img",{src:m,className:q.citationImg}):e.jsx("iframe",{title:"Citation",src:m,width:"100%",height:l})})]})},Mn="_container_cfwv2_1",Gn={container:Mn},On=({className:t,onClick:s})=>e.jsx("div",{className:`${Gn.container} ${t??""}`,children:e.jsx(fe,{icon:e.jsx(Jt,{}),onClick:s,children:"Developer settings"})}),Bn="_container_cfwv2_1",qn={container:Bn},Fn=({className:t,disabled:s,onClick:n})=>e.jsx("div",{className:`${qn.container} ${t??""}`,children:e.jsx(fe,{icon:e.jsx(Xt,{}),disabled:s,onClick:n,children:"Clear chat"})}),Un="_container_1pzrp_1",Vn={container:Un},$n=[{key:k.Embedding,text:"Text Embeddings"},{key:k.ImageEmbedding,text:"Image Embeddings"},{key:k.Both,text:"Text and Image embeddings"}],Hn=({updateRetrievalMode:t,updateVectorFields:s,showImageOptions:n})=>{const[l,o]=c.useState(b.Hybrid),[d,r]=c.useState(),u=(m,h)=>{o(h?.data||b.Hybrid),t(h?.data||b.Hybrid)},x=(m,h)=>{h&&r(h.key);let g;h?.key==="both"?g=[k.Embedding,k.ImageEmbedding]:g=[h?.key],s(g)};return c.useEffect(()=>{s(n?[k.Embedding,k.ImageEmbedding]:[k.Embedding])},[n]),e.jsxs(y,{className:Vn.container,tokens:{childrenGap:10},children:[e.jsx(qe,{label:"Retrieval mode",options:[{key:"hybrid",text:"Vectors + Text (Hybrid)",selected:l==b.Hybrid,data:b.Hybrid},{key:"vectors",text:"Vectors",selected:l==b.Vectors,data:b.Vectors},{key:"text",text:"Text",selected:l==b.Text,data:b.Text}],required:!0,onChange:u}),n&&[b.Vectors,b.Hybrid].includes(l)&&e.jsx(Ot,{options:$n,onChange:x,selectedKey:d,defaultSelectedKey:k.Both,label:"Vector Fields (Multi-query vector search)"})]})},Dn=()=>{const{instance:t}=z(),s=t.getActiveAccount(),n=r=>typeof r=="string"?r:JSON.stringify(r),o=(r=>Object.keys(r??{}).map(u=>{let x=u;try{const h=new URL(u).pathname.split("/");u=h[h.length-1]}catch{}return{name:u,value:n((r??{})[x])}}))(s?.idTokenClaims??G?.user_claims),d=[Pe({columnId:"name",compare:(r,u)=>r.name.localeCompare(u.name),renderHeaderCell:()=>"Name",renderCell:r=>r.name}),Pe({columnId:"value",compare:(r,u)=>r.value.localeCompare(u.value),renderHeaderCell:()=>"Value",renderCell:r=>r.value})];return e.jsxs("div",{children:[e.jsx(Bt,{children:"ID Token Claims"}),e.jsxs(qt,{items:o,columns:d,sortable:!0,getRowId:r=>r.name,children:[e.jsx(Ft,{children:e.jsx(Ee,{children:({renderHeaderCell:r})=>e.jsx(Ut,{children:r()})})}),e.jsx(Vt,{children:({item:r,rowId:u})=>e.jsx(Ee,{children:({renderCell:x})=>e.jsx($t,{children:x(r)})},u)})]})]})},Qn="_container_1pzrp_1",zn={container:Qn},Kn=({updateGPT4VInputs:t,updateUseGPT4V:s,isUseGPT4V:n,gpt4vInputs:l})=>{const[o,d]=c.useState(n),[r,u]=c.useState(l||I.TextAndImages),x=(h,g)=>{s(!!g),d(!!g)},m=(h,g)=>{if(g){const _=g.key;t(_||I.TextAndImages),_&&u(_)}};return c.useEffect(()=>{o&&t(I.TextAndImages)},[o]),e.jsxs(y,{className:zn.container,tokens:{childrenGap:10},children:[e.jsx(M,{checked:o,label:"Use GPT-4 Turbo with Vision",onChange:x}),o&&e.jsx(qe,{selectedKey:r,label:"GPT-4 Turbo with Vision Inputs",options:[{key:I.TextAndImages,text:"Images and text from index"},{text:"Images only",key:I.Images},{text:"Text only",key:I.Texts}],required:!0,onChange:m})]})},Wn=()=>{const[t,s]=c.useState(!1),[n,l]=c.useState(""),[o,d]=c.useState(.3),[r,u]=c.useState(3),[x,m]=c.useState(b.Hybrid),[h,g]=c.useState(!0),[_,C]=c.useState(!0),[L,oe]=c.useState(!1),[K,$e]=c.useState(""),[W,He]=c.useState(!1),[De,Qe]=c.useState([k.Embedding]),[Ce,ze]=c.useState(!1),[Se,Ke]=c.useState(!1),[ye,We]=c.useState(I.TextAndImages),[J,Je]=c.useState(!1),E=c.useRef(""),ae=c.useRef(null),[X,Y]=c.useState(!1),[ve,re]=c.useState(!1),[Z,ie]=c.useState(),[be,ce]=c.useState(),[U,O]=c.useState(void 0),[V,je]=c.useState(0),[T,ee]=c.useState([]),[Te,we]=c.useState([]),[ke,Xe]=c.useState(!1),[Ye,Ze]=c.useState(!1),[et,tt]=c.useState(!1),st=async()=>{const i=B?await ge(B):void 0;Fs(i).then(a=>{Xe(a.showGPT4VOptions),g(a.showSemanticRankerOption),Ze(a.showSemanticRankerOption),tt(a.showVectorOption),a.showVectorOption||m(b.Text)})},nt=async(i,a,w,le)=>{let A="",f={};const xt=S=>new Promise(_t=>{setTimeout(()=>{A+=S;const ft={...f,choices:[{...f.choices[0],message:{content:A,role:f.choices[0].message.role}}]};we([...a,[i,ft]]),_t(null)},33)});try{re(!0);for await(const S of Tt(le))if(S.choices&&S.choices[0].context&&S.choices[0].context.data_points)S.choices[0].message=S.choices[0].delta,f=S;else if(S.choices&&S.choices[0].delta.content)Y(!1),await xt(S.choices[0].delta.content);else if(S.choices&&S.choices[0].context)f.choices[0].context={...f.choices[0].context,...S.choices[0].context};else if(S.error)throw Error(S.error)}finally{re(!1)}return{...f,choices:[{...f.choices[0],message:{content:A,role:f.choices[0].message.role}}]}},B=P?z().instance:void 0,$=async i=>{E.current=i,Z&&ie(void 0),Y(!0),ce(void 0),O(void 0);const a=B?await ge(B):void 0;try{const le={messages:[...T.flatMap(f=>[{content:f[0],role:"user"},{content:f[1].choices[0].message.content,role:"assistant"}]),{content:i,role:"user"}],stream:_,context:{overrides:{prompt_template:n.length===0?void 0:n,exclude_category:K.length===0?void 0:K,top:r,temperature:o,retrieval_mode:x,semantic_ranker:h,semantic_captions:L,suggest_followup_questions:W,use_oid_security_filter:Ce,use_groups_security_filter:Se,vector_fields:De,use_gpt4v:J,gpt4v_input:ye}},session_state:T.length?T[T.length-1][1].choices[0].session_state:null},A=await Us(le,a);if(!A.body)throw Error("No response body");if(_){const f=await nt(i,T,ee,A.body);ee([...T,[i,f]])}else{const f=await A.json();if(A.status>299||!A.ok)throw Error(f.error||"Unknown error");ee([...T,[i,f]])}}catch(w){ie(w)}finally{Y(!1)}},ot=()=>{E.current="",Z&&ie(void 0),ce(void 0),O(void 0),ee([]),we([]),Y(!1),re(!1)};c.useEffect(()=>ae.current?.scrollIntoView({behavior:"smooth"}),[X]),c.useEffect(()=>ae.current?.scrollIntoView({behavior:"auto"}),[Te]),c.useEffect(()=>{st()},[]);const at=(i,a)=>{l(a||"")},rt=(i,a,w)=>{d(i)},it=(i,a)=>{u(parseInt(a||"3"))},ct=(i,a)=>{g(!!a)},lt=(i,a)=>{oe(!!a)},ut=(i,a)=>{C(!!a)},dt=(i,a)=>{$e(a||"")},ht=(i,a)=>{He(!!a)},pt=(i,a)=>{ze(!!a)},mt=(i,a)=>{Ke(!!a)},gt=i=>{$(i)},Ne=(i,a)=>{be===i&&U===N.CitationTab&&V===a?O(void 0):(ce(i),O(N.CitationTab)),je(a)},H=(i,a)=>{O(U===i&&V===a?void 0:i),je(a)};return e.jsxs("div",{className:p.container,children:[e.jsxs("div",{className:p.commandsContainer,children:[e.jsx(Fn,{className:p.commandButton,onClick:ot,disabled:!E.current||X}),e.jsx(On,{className:p.commandButton,onClick:()=>s(!t)})]}),e.jsxs("div",{className:p.chatRoot,children:[e.jsxs("div",{className:p.chatContainer,children:[E.current?e.jsxs("div",{className:p.chatMessageStream,children:[ve&&Te.map((i,a)=>e.jsxs("div",{children:[e.jsx(te,{message:i[0]}),e.jsx("div",{className:p.chatMessageGpt,children:e.jsx(Me,{isStreaming:!0,answer:i[1],isSelected:!1,onCitationClicked:w=>Ne(w,a),onThoughtProcessClicked:()=>H(N.ThoughtProcessTab,a),onSupportingContentClicked:()=>H(N.SupportingContentTab,a),onFollowupQuestionClicked:w=>$(w),showFollowupQuestions:W&&T.length-1===a},a)})]},a)),!ve&&T.map((i,a)=>e.jsxs("div",{children:[e.jsx(te,{message:i[0]}),e.jsx("div",{className:p.chatMessageGpt,children:e.jsx(Me,{isStreaming:!1,answer:i[1],isSelected:V===a&&U!==void 0,onCitationClicked:w=>Ne(w,a),onThoughtProcessClicked:()=>H(N.ThoughtProcessTab,a),onSupportingContentClicked:()=>H(N.SupportingContentTab,a),onFollowupQuestionClicked:w=>$(w),showFollowupQuestions:W&&T.length-1===a},a)})]},a)),X&&e.jsxs(e.Fragment,{children:[e.jsx(te,{message:E.current}),e.jsx("div",{className:p.chatMessageGptMinWidth,children:e.jsx(sn,{})})]}),Z?e.jsxs(e.Fragment,{children:[e.jsx(te,{message:E.current}),e.jsx("div",{className:p.chatMessageGptMinWidth,children:e.jsx(nn,{error:Z.toString(),onRetry:()=>$(E.current)})})]}):null,e.jsx("div",{ref:ae})]}):e.jsxs("div",{className:p.chatEmptyState,children:[e.jsx(Yt,{fontSize:"120px",primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Chat logo"}),e.jsx("h1",{className:p.chatEmptyStateTitle,children:"CHEFBOT"}),e.jsx("h2",{className:p.chatEmptyStateSubtitle,children:"Pergunte como fazer alguma receita ou selecione um exemplo"}),e.jsx(gn,{onExampleClicked:gt,useGPT4V:J})]}),e.jsx("div",{className:p.chatInput,children:e.jsx(cn,{clearOnSend:!0,placeholder:"Pergunte (Ex. Como fazer bolinho de arroz?)",disabled:X,onSend:i=>$(i)})})]}),T.length>0&&U&&e.jsx(Rn,{className:p.chatAnalysisPanel,activeCitation:be,onActiveTabChanged:i=>H(i,V),citationHeight:"810px",answer:T[V][1],activeTab:U}),e.jsxs(Ht,{headerText:"Configure answer generation",isOpen:t,isBlocking:!1,onDismiss:()=>s(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e.jsx(Be,{onClick:()=>s(!1),children:"Close"}),isFooterAtBottom:!0,children:[e.jsx(pe,{className:p.chatSettingsSeparator,defaultValue:n,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:at}),e.jsx(Dt,{className:p.chatSettingsSeparator,label:"Temperature",min:0,max:1,step:.1,defaultValue:o,onChange:rt,showValue:!0,snapToStep:!0}),e.jsx(Qt,{className:p.chatSettingsSeparator,label:"Retrieve this many search results:",min:1,max:50,defaultValue:r.toString(),onChange:it}),e.jsx(pe,{className:p.chatSettingsSeparator,label:"Exclude category",onChange:dt}),Ye&&e.jsx(M,{className:p.chatSettingsSeparator,checked:h,label:"Use semantic ranker for retrieval",onChange:ct}),e.jsx(M,{className:p.chatSettingsSeparator,checked:L,label:"Use query-contextual summaries instead of whole documents",onChange:lt,disabled:!h}),e.jsx(M,{className:p.chatSettingsSeparator,checked:W,label:"Suggest follow-up questions",onChange:ht}),ke&&e.jsx(Kn,{gpt4vInputs:ye,isUseGPT4V:J,updateUseGPT4V:i=>{Je(i)},updateGPT4VInputs:i=>We(i)}),et&&e.jsx(Hn,{showImageOptions:J&&ke,updateVectorFields:i=>Qe(i),updateRetrievalMode:i=>m(i)}),P&&e.jsx(M,{className:p.chatSettingsSeparator,checked:Ce||D,label:"Use oid security filter",disabled:!me(B)||D,onChange:pt}),P&&e.jsx(M,{className:p.chatSettingsSeparator,checked:Se||D,label:"Use groups security filter",disabled:!me(B)||D,onChange:mt}),e.jsx(M,{className:p.chatSettingsSeparator,checked:_,label:"Stream chat completion responses",onChange:ut}),P&&e.jsx(Dn,{})]})]})]})};var _e;if(P){var R=new wt(ns);!R.getActiveAccount()&&R.getAllAccounts().length>0&&R.setActiveAccount(R.getActiveAccount()),R.addEventCallback(t=>{if(t.eventType===kt.LOGIN_SUCCESS&&t.payload){const s=t.payload;R.setActiveAccount(s)}}),_e=e.jsx(Et,{instance:R,children:e.jsx(Re,{})})}else _e=e.jsx(Re,{});Nt();const Jn=Lt([{path:"/",element:_e,children:[{index:!0,element:e.jsx(Wn,{})},{path:"qa",lazy:()=>Ae(()=>import("./Ask-aac31cda.js"),["assets/Ask-aac31cda.js","assets/vendor-3b0eb66e.js","assets/fluentui-react-cc049b91.js","assets/fluentui-icons-cc979dd7.js","assets/Ask-4461589d.css"])},{path:"*",lazy:()=>Ae(()=>import("./NoPage-53567df7.js"),["assets/NoPage-53567df7.js","assets/vendor-3b0eb66e.js"])}]}]);At.createRoot(document.getElementById("root")).render(e.jsx(It.StrictMode,{children:e.jsx(Pt,{router:Jn})}));export{Me as A,gn as E,I as G,cn as Q,b as R,On as S,Dn as T,k as V,N as a,nn as b,Rn as c,Kn as d,Hn as e,Fs as f,ge as g,to as h,me as i,D as r,P as u};
//# sourceMappingURL=index-29243e77.js.map
