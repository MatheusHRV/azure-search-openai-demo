import{r as s,bE as Te,bF as t}from"./vendor-3b0eb66e.js";import{R as Q,G as be,V as L,u as d,S as ye,Q as Pe,E as je,A as we,a as m,b as Ae,c as Ve,d as Oe,e as Re,r as S,i as M,T as Ne,g as q,f as Ie,h as Ge}from"./index-29243e77.js";import{p as Ee,m as Ue,D as Be,T as D,n as Fe,o as Qe,l as g}from"./fluentui-react-cc049b91.js";import"./fluentui-icons-cc979dd7.js";const Le="_askContainer_1vvbs_1",Me="_askTopSection_1vvbs_8",qe="_askBottomSection_1vvbs_15",De="_askTitle_1vvbs_25",He="_askQuestionInput_1vvbs_39",ze="_askAnswerContainer_1vvbs_46",Je="_askAnalysisPanel_1vvbs_53",Ke="_askSettingsSeparator_1vvbs_58",We="_settingsButton_1vvbs_62",n={askContainer:Le,askTopSection:Me,askBottomSection:qe,askTitle:De,askQuestionInput:He,askAnswerContainer:ze,askAnalysisPanel:Je,askSettingsSeparator:Ke,settingsButton:We};function Xe(){const[T,v]=s.useState(!1),[h,H]=s.useState(""),[b,Ye]=s.useState(""),[y,Ze]=s.useState(""),[P,z]=s.useState(.3),[J,j]=s.useState(Q.Hybrid),[w,K]=s.useState(3),[k,A]=s.useState(!0),[V,W]=s.useState(!1),[l,X]=s.useState(!1),[O,Y]=s.useState(be.TextAndImages),[R,Z]=s.useState(""),[$,ee]=s.useState(""),[te,se]=s.useState([L.Embedding,L.ImageEmbedding]),[N,ae]=s.useState(!1),[I,ne]=s.useState(!1),[G,oe]=s.useState(!1),[ie,re]=s.useState(!1),[le,ce]=s.useState(!1),C=s.useRef(""),[x,E]=s.useState(!1),[c,U]=s.useState(),[o,ue]=s.useState(),[B,F]=s.useState(),[u,r]=s.useState(void 0),i=d?Te().instance:void 0,pe=async()=>{const e=i?await q(i):void 0;Ie(e).then(a=>{oe(a.showGPT4VOptions),A(a.showSemanticRankerOption),re(a.showSemanticRankerOption),ce(a.showVectorOption),a.showVectorOption||j(Q.Text)})};s.useEffect(()=>{pe()},[]);const _=async e=>{C.current=e,c&&U(void 0),E(!0),F(void 0),r(void 0);const a=i?await q(i):void 0;try{const p={messages:[{content:e,role:"user"}],context:{overrides:{prompt_template:h.length===0?void 0:h,prompt_template_prefix:b.length===0?void 0:b,prompt_template_suffix:y.length===0?void 0:y,exclude_category:R.length===0?void 0:R,top:w,temperature:P,retrieval_mode:J,semantic_ranker:k,semantic_captions:V,use_oid_security_filter:N,use_groups_security_filter:I,vector_fields:te,use_gpt4v:l,gpt4v_input:O}},session_state:o?o.choices[0].session_state:null},fe=await Ge(p,a);ue(fe)}catch(p){U(p)}finally{E(!1)}},de=(e,a)=>{H(a||"")},me=(e,a,p)=>{z(e)},Se=(e,a)=>{K(parseInt(a||"3"))},ge=(e,a)=>{A(!!a)},ve=(e,a)=>{W(!!a)},he=(e,a)=>{Z(a||"")},ke=e=>{_(e),ee(e)},Ce=e=>{B===e&&u===m.CitationTab?r(void 0):(F(e),r(m.CitationTab))},f=e=>{r(u===e?void 0:e)},xe=(e,a)=>{ae(!!a)},_e=(e,a)=>{ne(!!a)};return t.jsxs("div",{className:n.askContainer,children:[t.jsxs("div",{className:n.askTopSection,children:[t.jsx(ye,{className:n.settingsButton,onClick:()=>v(!T)}),t.jsx("h1",{className:n.askTitle,children:"Pergunte ao chefe"}),t.jsx("div",{className:n.askQuestionInput,children:t.jsx(Pe,{placeholder:"Exemplo: Como fazer farÃ³fa de banana?",disabled:x,initQuestion:$,onSend:e=>_(e)})})]}),t.jsxs("div",{className:n.askBottomSection,children:[x&&t.jsx(Ee,{label:"Generating answer"}),!C.current&&t.jsx(je,{onExampleClicked:ke,useGPT4V:l}),!x&&o&&!c&&t.jsx("div",{className:n.askAnswerContainer,children:t.jsx(we,{answer:o,isStreaming:!1,onCitationClicked:e=>Ce(e),onThoughtProcessClicked:()=>f(m.ThoughtProcessTab),onSupportingContentClicked:()=>f(m.SupportingContentTab)})}),c?t.jsx("div",{className:n.askAnswerContainer,children:t.jsx(Ae,{error:c.toString(),onRetry:()=>_(C.current)})}):null,u&&o&&t.jsx(Ve,{className:n.askAnalysisPanel,activeCitation:B,onActiveTabChanged:e=>f(e),citationHeight:"600px",answer:o,activeTab:u})]}),t.jsxs(Ue,{headerText:"Configure answer generation",isOpen:T,isBlocking:!1,onDismiss:()=>v(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>t.jsx(Be,{onClick:()=>v(!1),children:"Close"}),isFooterAtBottom:!0,children:[t.jsx(D,{className:n.askSettingsSeparator,defaultValue:h,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:de}),t.jsx(Fe,{className:n.chatSettingsSeparator,label:"Temperature",min:0,max:1,step:.1,defaultValue:P,onChange:me,showValue:!0,snapToStep:!0}),t.jsx(Qe,{className:n.askSettingsSeparator,label:"Retrieve this many search results:",min:1,max:50,defaultValue:w.toString(),onChange:Se}),t.jsx(D,{className:n.askSettingsSeparator,label:"Exclude category",onChange:he}),ie&&t.jsx(g,{className:n.askSettingsSeparator,checked:k,label:"Use semantic ranker for retrieval",onChange:ge}),t.jsx(g,{className:n.askSettingsSeparator,checked:V,label:"Use query-contextual summaries instead of whole documents",onChange:ve,disabled:!k}),G&&t.jsx(Oe,{gpt4vInputs:O,isUseGPT4V:l,updateUseGPT4V:e=>{X(e)},updateGPT4VInputs:e=>Y(e)}),le&&t.jsx(Re,{showImageOptions:l&&G,updateVectorFields:e=>se(e),updateRetrievalMode:e=>j(e)}),d&&t.jsx(g,{className:n.askSettingsSeparator,checked:N||S,label:"Use oid security filter",disabled:!M(i)||S,onChange:xe}),d&&t.jsx(g,{className:n.askSettingsSeparator,checked:I||S,label:"Use groups security filter",disabled:!M(i)||S,onChange:_e}),d&&t.jsx(Ne,{})]})]})}Xe.displayName="Ask";export{Xe as Component};
//# sourceMappingURL=Ask-aac31cda.js.map
